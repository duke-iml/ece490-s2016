import math
from klampt import vectorops,so3

# Constants that affect the state machine
INITIAL_STATE = "START"
REAL_VACUUM = True
REAL_PERCEPTION = True
SEGMENT = True
CALIBRATE_CAMERA = False
SELECT_REAL_BIN = True
HARDCODED_BIN = 'H'
DRY_RUN = False

# Constants related to printing output
PRINT_BLOBS = False
PRINT_LABELS_AND_SCORES = True
DEBUG_PERCEPTION = True

# Downsample ratio
STEP = 15

# Right arm configurations

#################################################################################

Q_SCAN_BIN_A = [1.0001554725585937, -0.9054321590148926, 0.20171847337646487, 0.411490345880127, -0.11274758778076173, 2.093500277874756, -1.2]
Q_SCAN_BIN_A_HAYDEN = [1.1002477188537598, -0.8245146725463868, -0.13805827075195312, 0.7232719406616211, 1.7690633416076662, 1.275888518865967, -0.15186409782714844]
Q_BEFORE_SCAN_A = [[1.1106020891601562, -0.8038059319335938, -0.18829614149780274, 2.361563420251465, 0.00728640873413086, 0.02914563493652344, -0.0065194183410644535], [1.157388503137207, -0.7274903878234864, -0.15186409782714844, 0.7949855424133301, 0.013422331878662111, 1.517873987878418, 0.0122718462890625]]


Q_IK_SEED_A_KEVIN = [-0.04716990917358399, -1.366776880444336, 1.142048695275879, 1.4561312612365724, -0.004601942358398438, 0.09855826550903321, 0.0]

Q_IK_SEED_A = [0.2745825607177735, -1.2889273555480958, 1.2425244367675783, 1.2425244367675783, -1.5757817625549317, 0.468247634967041, 1.321524447253418]
# bACKUP  [0.2956747965270996, -0.7735098114074708, 1.5788497241271973, 1.2356215232299805, -2.3005876840026858, 0.7712088402282715, 1.3518205677795412]


#Transition from after scan to ik_seed is busted
Q_AFTER_SCAN_A = [[1.1884516140563965, -0.7359272821472168, -0.17487380961914065, 0.9572040105468751, 0.10316020786743164, 1.3430001782592775, -0.0487038899597168], [1.180014719732666, -0.7447476716674806, -0.13115535721435548, 2.2507333084533694, 0.10469418865356446, 0.042951462011718754, -0.04947088035278321],
[0.7271068926269532, -0.7255729118408204, -0.06864564017944337, 2.302888655181885, -0.13882526114501953, -0.08206797205810547, 0.07439806812744142],
[0.6661311563781739, -0.6845389258117677, -0.013805827075195313, 2.1863061154357912, -1.8983012228393557, 0.06634466900024415, 1.5677283634277346],
[0.46364569260864263, 0.11696603494262696, 1.5504710795837404, 1.9504565695678713, -1.7510390673706056, 1.5661943826416016, 1.597257493560791],
[0.43181559129638675, -0.8333350620666504, 1.680092456011963, 1.8300390778564455, -0.7405292245056153, 1.5401167092773438, 1.598791474346924],
[0.1334563283935547, -0.8693836105407715, 2.0543837678283694, 1.7333982883300783, -2.282563409765625, 1.4381069869995118, 1.3506700821899416],
[0.2070874061279297, -1.1957380227905274, 1.6808594464050295, 1.2237331721374514, -1.6551652682373048, 1.0013059581481933, 1.2977477450683594]]
Q_AFTER_GRASP_A = [
[0.2070874061279297, -1.1957380227905274, 1.6808594464050295, 1.2237331721374514, -1.6551652682373048, 1.0013059581481933, 1.2977477450683594],
[0.021092235809326173, -1.2264176385131837, 1.7874711110412598, 1.2540292926635743, -1.5508545747802736, 0.9280583756103516, 1.3123205625366212],
[0.3401602393249512, -1.1857671476806642, 1.7218934324340822, 0.5622039581176759, -0.9924855686279298, 1.4208497031555176, 0.6584612524475099],
[0.38119422535400393, -1.0277671267089845, 1.5466361276184084, 0.9901845974487306, -0.7129175703552246, 1.6524808018615724, 0.5599029869384766],
[0.2876213973999024, -0.781563210534668, 1.5546895267456056, 2.37536924732666, -1.7786507215209961, 1.0799224734375001, 1.810097327636719],
[0.37889325417480474, -0.8064903983093262, 0.9641069240844727, 2.0888983355163577, -1.404742904901123, 0.521169972088623, 1.1155875267150879],
[0.4394854952270508, -0.8199127301879884, 0.6028544489501954, 1.916325497076416, -0.4613447214294434, 0.2557912960876465, -0.060592241052246094]
]

################################################################################################
Q_SCAN_BIN_B = [0.7420632052917481, -1.0772380070617678, 0.08743690480957032, 0.7121505799621582, -0.056373793890380865, 1.9324322953308106, -0.023776702185058594]
Q_SCAN_BIN_B_HAYDEN = [0.8298836052978517, -0.8214467109741211, -0.194432064642334, 0.3762087877990723, 0.16298545852661134, 1.9995439547241212, -0.1464951650756836]
Q_IK_SEED_B = [-0.7336263109680177, -1.4154807704040528, 1.625252642907715, 1.5727138009826662, 0.021475731005859377, -0.19711653101806642, -0.09050486638183594]
# backup [0.03988350043945313, -1.3491361014038086, 0.8935438079223633, 1.1700438446228028, 0.06250971703491211, 0.23738352665405274, -0.23278158429565432]

Q_AFTER_SCAN_B = [
[-1.3790487267333986, -1.3449176542419434, 2.281796419372559, 1.0580632472351075, -0.08321845764770508, 1.5846021520751954, 0.09280583756103516],
[-1.41394678961792, -1.2413739511779787, 2.2756604962280274, 1.7391507162780764, -0.11965050131835939, -0.08168447686157228, 0.06212622183837891]
]


#Q_AFTER_SCAN_B_OLD = [
#[0.977912751159668, -0.5744758044067383, -0.12616991965942384, 2.119577951239014, -0.03451456768798828, 0.021475731005859377, 0.04985437554931641],
#[0.05253884192504883, -0.7106165991760255, -0.024160197381591798, 2.048247844683838, 3.0595246779418948, -0.3501311144348145, 0.11198059738769532],
#[0.1714223528503418, -0.783480686517334, -0.06596117380371094, 2.2886993329101566, 3.060291668334961, 1.447694366912842, 3.049170307635498],
#[-0.01687378864746094, -0.5376602655395508, -0.1449611842895508, 1.9980099739379884, 0.7926845712341309, 1.7023351774108888, 0.005368932751464844],
#[0.15263108822021484, 0.43565054326171876, 3.0062188456237795, 2.089665325909424, 2.5287673259399415, 1.6973497398559572, 0.32021848910522466],
#[0.7386117485229493, 0.3305728594116211, 2.9759227250976563, 2.1886070866149905, 3.0587576875488285, 1.6927477974975587, 0.3393932489318848]]

Q_BEFORE_SCAN_B = [[0.8839564280090333, -0.7539515563842774, -0.1817767231567383, 2.2756604962280274, 0.1606844873474121, 0.16221846813354493, -0.18944662708740237]]

Q_AFTER_GRASP_B = [
[-1.41394678961792, -1.2413739511779787, 2.2756604962280274, 1.7391507162780764, -0.11965050131835939, -0.08168447686157228, 0.06212622183837891],
[-1.3134710481262208, -1.2294856000854493, 2.2541847652221683, 1.0208642131713868, -0.012655341485595705, 1.2429079319641114, 0.07631554411010742],
[-0.8091748646850586, -1.4170147511901856, 1.6566992490234376, 2.4018304158874515, -0.12693691005249025, 0.5537670637939454, 0.1721893432434082], 
[0.6761020314880372, -1.1148205363220216, 0.0364320436706543, 2.4739275128356937, -0.053689327514648444, -0.030296120526123047, 0.02185922620239258]
]


################################################################################################
Q_SCAN_BIN_C = [0.7244224262512208, -1.0875923773681642, -0.2807184838623047, 0.7677573834594728, 0.030296120526123047, 1.8484468472900393, -0.2807184838623047]
Q_SCAN_BIN_C_HAYDEN = [0.9088836157836915, -0.7075486376037599, -0.9472331354370118, 0.7884661240722657, -0.8413884611938477, 1.1017816996398926, -0.1342233187866211]

Q_IK_SEED_C = [0.06250971703491211, -1.3472186254211427, 0.05714078428344727, 1.1332283057556154, 1.4730050498840332, 0.8275826341186524, -1.3242089136291504]
# backup [0.36393694151000977, -1.2198982201721191, -0.24121847861938478, 1.1443496664550783, 1.7955245101684572, 0.5399612367187501, -1.64979633548584]


Q_AFTER_SCAN_C = [
[0.5829126987304688, -1.1627574358886719, -0.07056311616210938, 2.4474663442749027, -0.010737865502929688, 0.2439029449951172, 0.11658253974609376],
[-0.45789326466064456, -1.4058933904907227, 0.12847089083862306, 1.5378157380981445, -0.018024274237060548, 1.56120894508667, -1.5358982621154786],
[-0.45981074064331057, -1.4135632944213867, 0.2684466375732422, 1.4338885398376466, 1.6816264367980958, 1.1784807389465333, -1.6946652734802248],
[-0.2070874061279297, -1.391320573022461, 0.07593204891357422, 1.2371555040161133, 1.5293788437744142, 1.200723460345459, -1.3564225101379395]
]

Q_BEFORE_SCAN_C = [[0.8839564280090333, -0.7539515563842774, -0.1817767231567383, 2.2756604962280274, 0.1606844873474121, 0.16221846813354493, -0.18944662708740237]]
Q_AFTER_GRASP_C = [
[-0.2070874061279297, -1.391320573022461, 0.07593204891357422, 1.2371555040161133, 1.5293788437744142, 1.200723460345459, -1.3564225101379395],
[-0.45981074064331057, -1.4135632944213867, 0.2684466375732422, 1.4338885398376466, 1.6816264367980958, 1.1784807389465333, -1.6946652734802248],
[-0.509665116192627, -1.4147137800109864, 0.15186409782714844, 1.6356070132141114, 1.0526943144836427, 1.5730972961791994, -1.7679128560180666],
[0.8574952594482422, -0.9882671214660645, 0.013038836682128907, 2.191675048187256, 0.0487038899597168, -0.04640291878051758, -0.03451456768798828]]

################################################################################################
Q_SCAN_BIN_D = [1.2018739459350587, -0.7244224262512208, -0.3723738358337403, 0.6254806655456543, 0.4494563703369141, 1.9013691844116212, 0.002684466375732422]
Q_SCAN_BIN_D_HAYDEN = [1.4028254289184572, -0.4571262742675782, -1.0285341171020508, 0.5234709432678223, 0.8716845817199708, 1.7142235285034182, -0.03067961572265625]
Q_IK_SEED_D = [0.7152185415344239, -1.092961310119629, 0.45674277907104494, 1.5040681608032227, 0.12156797730102539, -0.3777427685852051, -0.3044951860473633]

Q_AFTER_SCAN_D = [
[0.6408204734069824, -0.8571117642517091, -0.042184471618652346, 2.408349834228516, -0.05560680349731446, -0.09664078952636719, 0.18024274237060547],
[0.2634612000183106, -1.2916118219238282, 0.93266031796875, 2.443247897113037, 0.6860729065979004, 0.19059711267700197, -0.3535825712036133],
[0.2822524646484375, -1.2870098795654297, 1.2133788018310547, 2.3531265259277347, 0.615509790435791, -1.379815717126465, -0.4755340437011719],
[-0.16336895372314456, -1.3859516402709962, 1.2337040472473146, 2.265306125921631, -0.26039323844604495, -0.8498253555175782, 0.003067961572265625],
[0.17564080001220705, -1.3184564856811525, 0.945699154650879, 1.9259128769897462, -0.11504855895996094, -0.4835874428283692, -0.0970242847229004],


]

Q_BEFORE_SCAN_D = [[0.8839564280090333, -0.7539515563842774, -0.1817767231567383, 2.2756604962280274, 0.1606844873474121, 0.16221846813354493, -0.18944662708740237]]

Q_AFTER_GRASP_D = [
[0.17564080001220705, -1.3184564856811525, 0.945699154650879, 1.9259128769897462, -0.11504855895996094, -0.4835874428283692, -0.0970242847229004],
[-0.16336895372314456, -1.3859516402709962, 1.2337040472473146, 2.265306125921631, -0.26039323844604495, -0.8498253555175782, 0.003067961572265625],
[0.009587379913330078, -1.2935292979064943, 1.0001554725585937, 2.5847576246337893, -0.3443786864868164, -1.3936215442016602, -0.06941263057250976],
[0.04908738515625, -1.3487526062072754, 0.8479078795349122, 2.5951119949401855, -1.3127040577331544, -0.7911505904479981, 0.09012137118530274],
[0.6787864978637695, -0.8068738935058595, -0.019941750219726564, 2.450150810650635, -0.3570340279724121, -0.7558690323669434, 0.15186409782714844]

]

################################################################################################
Q_SCAN_BIN_E = [0.8973787598876953, -0.9775292559631348, -0.13959225153808594, 0.9621894481018067, 0.08283496245117188, 1.8595682079895022, -0.21782527163085938]
Q_SCAN_BIN_E_HAYDEN = [0.7574030131530762, -0.37007286465454103, 0.09127185677490235, 0.026077673364257814, -0.09549030393676758, 1.9182429730590822, -0.01112136069946289]
Q_IK_SEED_E = [-0.09587379913330078, -0.24582042097778323, 1.7333982883300783, 1.7337817835266114, 0.22511168036499024, -0.8824224472229004, -1.5953400175781252]

# backup [-0.33594179216308595, -0.06864564017944337, 1.7583254761047364, 1.92399540100708, 0.10200972227783203, -0.8463738987487793, -1.6030099215087892]
Q_AFTER_SCAN_E = [
[-0.03988350043945313, -1.36485940446167, 0.8563447738586426, 1.9792187093078615, -0.03298058690185547, 1.023165184350586, 0.20095148298339846],
[-0.4329660768859864, -1.3318788175598146, 1.397073000970459, 2.6177382115356447, 2.579005196685791, -0.5533835685974121, -2.119577951239014],
[-0.5250049240539552, -0.08628641921997071, 1.762927418463135, 2.5866751006164552, 1.6195002149597169, -1.568878849017334, -1.6114468158325197],
[-0.5729418236206055, -0.05062136594238282, 1.876441996636963, 2.4628061521362308, 0.2051699301452637, -1.1355292769348144, -1.613747787011719],
[-0.3382427633422852, -0.10124273188476564, 1.8434614097351076, 2.157543975695801, 0.17333982883300783, -0.9729273136047364, -1.5918885608093263]
]
Q_BEFORE_SCAN_E = [[0.8839564280090333, -0.7539515563842774, -0.1817767231567383, 2.2756604962280274, 0.1606844873474121, 0.16221846813354493, -0.18944662708740237]]

Q_AFTER_GRASP_E = [
[-0.3382427633422852, -0.10124273188476564, 1.8434614097351076, 2.157543975695801, 0.17333982883300783, -0.9729273136047364, -1.5918885608093263],
[-0.5729418236206055, -0.05062136594238282, 1.876441996636963, 2.4628061521362308, 0.2051699301452637, -1.1355292769348144, -1.613747787011719],
[-0.6672816419677735, -0.010354370306396484, 2.020252695336914, 2.5851411198303222, 0.41992724020385747, -1.1385972385070802, -1.621417690942383],
[-0.5595194917419434, -0.04180097642211914, 1.508286607965088, 2.5095925661132816, 0.7144515511413575, -1.211844821044922, -1.6118303110290528],
[0.18906313189086915, -0.8935438079223633, 0.8034224367370606, 2.358111963482666, 1.2831749276000977, -0.4368010288513184, -1.565043897052002],
[0.5579855109558106, -0.6596117380371094, 0.25847576246337894, 2.121878922418213, -0.06442719301757813, -0.10316020786743164, 0.014189322271728517]
]

################################################################################################
# shortcutting may be possible
Q_SCAN_BIN_F = [0.7961360280029297, -1.0411894585876464, -0.34667965766601566, 1.2870098795654297, 0.04026699563598633, 1.3602574621032715, -0.1975000262145996]
Q_SCAN_BIN_F_HAYDEN =  [0.5867476506958008, -0.3140825659606934, -0.17525730481567384, 0.3758252926025391, -1.4787574778320314, 1.2064758882934572, -0.04486893799438477]
Q_IK_SEED_F = [0.20440293975219728, -1.310019591357422, 0.16375244891967775, 1.8829614149780274, -0.5744758044067383, -0.7884661240722657, 0.45252433190917973]

Q_AFTER_SCAN_F = [
	[-0.08897088559570313, -1.3464516350280762, 0.0724805921447754, 2.351976040338135, -1.0208642131713868, 0.1695048768676758, 0.28301945504150394],
	[-0.14879613625488283, -1.3832671738952638, 0.16221846813354493, 2.309024578326416, -0.7370777677368164, -1.2406069607849122, 0.49010686116943364],
	[0.10239321747436524, -1.3368642551147463, 0.17832526638793947, 2.0639711477416993, -0.5748592996032715, -0.9610389625122071, 0.44562141837158203]
]
Q_BEFORE_SCAN_F = [[0.8839564280090333, -0.7539515563842774, -0.1817767231567383, 2.2756604962280274, 0.1606844873474121, 0.16221846813354493, -0.18944662708740237]]
Q_AFTER_GRASP_F = [
[0.10239321747436524, -1.3368642551147463, 0.17832526638793947, 2.0639711477416993, -0.5748592996032715, -0.9610389625122071, 0.44562141837158203],
[-0.14879613625488283, -1.3832671738952638, 0.16221846813354493, 2.309024578326416, -0.7370777677368164, -1.2406069607849122, 0.49010686116943364],
[-0.30986411879882814, -1.3959225153808594, -0.007669903930664063, 2.4854323687316895, -1.0108933380615235, -1.4718545642944336, 0.49049035636596683],
[-0.04026699563598633, -1.212228316241455, 0.11236409258422853, 2.3815051704711916, -1.0446409153564453, -0.6273981415283204, 0.4981602602966309],
[0.9748447895874024, -0.9073496349975586, 0.23700003145751955, 2.4716265416564944, 0.2323980890991211, -0.28493693102416995, -0.03451456768798828]
]

###############################################################################################
Q_SCAN_BIN_G = [1.275888518865967, -0.6488738725341797, -0.2818689694519043, 1.153553551171875, 0.3010437292785645, 1.2225826865478517, 0.32635441224975587]
Q_SCAN_BIN_G_HAYDEN = [1.1508690847961427, -0.2193592524169922, -0.13499030917968752, 0.43526704806518557, 0.1683543912780762, 1.329194351184082, 0.24927187774658205]
Q_IK_SEED_G = [0.9123350725524902, -0.9660244000671387, 0.33018936421508793, 1.959276959088135, 0.3420777153076172, -1.0028399389343263, -0.4061214131286621]
Q_AFTER_SCAN_G = [
	[1.1036991756225587, -0.8214467109741211, 0.22281070918579102, 2.2327090342163087, 0.33210684019775394, -0.08935438079223633, -0.1852281799255371],
	[0.9545195441711426, -0.9376457555236817, 0.41685927863159183, 2.3189954534362793, 0.4839709380249024, -1.570796325, -0.18752915110473634],
	[0.9330438131652833, -0.9541360489746095, 0.37314082622680667, 2.0961847442504884, 0.40957286989746094, -1.1961215179870606, -0.19059711267700197]
]

Q_BEFORE_SCAN_G = [[0.8839564280090333, -0.7539515563842774, -0.1817767231567383, 2.2756604962280274, 0.1606844873474121, 0.16221846813354493, -0.18944662708740237]
]
Q_AFTER_GRASP_G = [
	[0.9330438131652833, -0.9541360489746095, 0.37314082622680667, 2.0961847442504884, 0.40957286989746094, -1.1961215179870606, -0.19059711267700197],
	[0.7907670952514649, -1.042339944177246, 0.41839325941772465, 2.2863983617309573, 0.2914563493652344, -1.1922865660217286, -0.20095148298339846],
	[0.7232719406616211, -1.0868253869750977, 0.26116022883911133, 2.5847576246337893, -0.3390097537353516, -1.457281746826172, 0.005368932751464844],
	[0.9019807022460938, -0.7708253450317384, 0.21360682446899415, 2.207014856048584, -0.3443786864868164, -0.3555000471862793, 0.050237870745849615]
]

################################################################################################
Q_BEFORE_SCAN_H = []
Q_SCAN_BIN_H = [0.9951700350036622, -0.8333350620666504, -0.21514080525512697, 1.440024462982178, 0.10316020786743164, 1.0925778149230958, -0.22319420438232423]
Q_IK_SEED_H = [0.8241311773498535, -0.9698593520324708, -0.027228158953857422, 2.065888623724365, -0.024160197381591798, -1.1086846131774903, -0.11926700612182618]
Q_AFTER_SCAN_H = [
	[0.5740923092102052, -1.1692768542297365, 0.12923788123168947, 2.5866751006164552, -0.06941263057250976, 0.02185922620239258, 0.0],
	[-0.26192721923217777, -1.2793399756347656, 0.053689327514648444, 2.5839906342407226, -0.32328645067749023, 0.05483981310424805, 0.00613592314453125],
	[-0.03719903406372071, -1.2919953171203613, -0.03451456768798828, 2.5475585905700684, -1.143966171258545, -1.3188399808776856, 0.06902913537597656],
	[0.694509800921631, -0.9898011022521973, -0.05944175546264649, 2.323980890991211, -0.24505343058471682, -1.3901700874328615, 0.0]
]

Q_AFTER_GRASP_H = [
	[0.694509800921631, -0.9898011022521973, -0.05944175546264649, 2.323980890991211, -0.24505343058471682, -1.3901700874328615, 0.0],
	[-0.03719903406372071, -1.2919953171203613, -0.03451456768798828, 2.5475585905700684, -1.143966171258545, -1.3188399808776856, 0.06902913537597656],
	[0.3543495615966797, -1.236388513623047, -0.07056311616210938, 2.5000051861999513, -1.447694366912842, -0.6005534777709961, 0.9572040105468751],
	[1.12900985859375, -0.5319078375915528, -0.10431069345703126, 1.9573594831054688, -1.2586312350219728, -0.13499030917968752, 1.2260341433166504]
]

################################################################################################
Q_SCAN_BIN_I = [0.7481991284362793, -0.8214467109741211, -0.29835926290283205, 1.5010001992309572, 0.06404369782104492, 0.97216032321167, -0.12540292926635743]
Q_IK_SEED_I = [0.24965537294311524, -0.9196214812866211, 0.1928980838562012, 1.9285973433654786, -0.2316310987060547, -1.0223981939575195, 0.00728640873413086]
Q_AFTER_SCAN_I = [
	[0.1353738043762207, -1.0177962515991212, -0.13729128035888674, 2.2515002988464357, -0.7466651476501466, 0.11619904454956055, 0.09510680874023437],
	[0.1338398235900879, -1.3280438655944826, -0.16566992490234375, 2.5874420910095215, -0.8874078847778321, -1.3430001782592775, 0.09549030393676758],
	[0.39423306203613284, -1.244058417553711, -0.17487380961914065, 2.1544760141235355, -0.7953690376098633, -0.8571117642517091, 0.3060291668334961]
]

Q_BEFORE_SCAN_I = []

Q_AFTER_GRASP_I = [
	[0.39423306203613284, -1.244058417553711, -0.17487380961914065, 2.1544760141235355, -0.7953690376098633, -0.8571117642517091, 0.3060291668334961],
	[0.1338398235900879, -1.3280438655944826, -0.16566992490234375, 2.5874420910095215, -0.8874078847778321, -1.3430001782592775, 0.09549030393676758],
	[0.5215534672851563, -1.1922865660217286, -0.15301458341674806, 2.5928110237609867, -1.3656263948547365, -1.1029321852294922, 0.169888372064209],
	[0.6561602812683106, -0.702179704852295, 0.21322332927246096, 2.2779614674072266, -0.3654709222961426, -0.34667965766601566, -0.06404369782104492]
]

################################################################################################
Q_SCAN_BIN_J = [1.5209419494506837, -0.23738352665405274, -0.48205346204223637, 1.1056166516052246, 0.8141603022399903, 0.9556700297607422, 0.011888351092529297]
Q_SCAN_BIN_J_HAYDEN = [1.0143447948303224, 0.25118935372924805, 0.37083985504760747, 0.21207284368286133, -0.32328645067749023, 1.208393364276123, 0.14419419389648439]
Q_IK_SEED_J = [1.196888508380127, -0.3286553834289551, -0.014956312664794923, 1.5826846760925295, 0.30948062360229495, -1.2578642446289063, -0.04486893799438477]
Q_AFTER_SCAN_J = [
	[1.508286607965088, -0.4007524803771973, -0.08321845764770508, 2.1794032018981935, 0.5928835738403321, -0.4287476297241211, 0.10507768385009766],
	[1.5182574830749513, -0.4252961729553223, -0.03873301484985352, 2.1479565957824707, 0.6139758096496583, -1.5692623442138673, 0.09127185677490235],
	[1.134378791345215, -0.7781117537658692, 0.04985437554931641, 2.273359525048828, 0.12885438603515625, -1.278189490045166, 0.021092235809326173]
]
Q_BEFORE_SCAN_J = [[0.8839564280090333, -0.7539515563842774, -0.1817767231567383, 2.2756604962280274, 0.1606844873474121, 0.16221846813354493, -0.18944662708740237]]

Q_AFTER_GRASP_J = [
	[1.134378791345215, -0.7781117537658692, 0.04985437554931641, 2.273359525048828, 0.12885438603515625, -1.278189490045166, 0.021092235809326173],
	[1.5182574830749513, -0.4252961729553223, -0.03873301484985352, 2.1479565957824707, 0.6139758096496583, -1.5692623442138673, 0.09127185677490235],
	[1.510204083947754, -0.41302432666625977, -0.08130098166503907, 2.1326167879211426, 0.47706802448730473, -0.6826214498291016, 0.11773302533569337]
]

################################################################################################
Q_SCAN_BIN_K = [1.1159710219116212, -0.21629129084472656, -0.339776744128418, 1.183466176501465, 0.41916024981079103, 0.747432138043213, -0.15186409782714844]
Q_SCAN_BIN_K_HAYDEN = [0.8057234079162598, 0.17985924717407228, -0.0609757362487793, 0.37390781661987305, -0.0015339807861328126, 1.0166457660095216, -0.016106798254394532]
Q_IK_SEED_K = [0.598252506591797, -0.4003689851806641, 0.10661166463623048, 1.8185342219604494, -0.17985924717407228, -1.357189500531006, -0.002300971179199219]
Q_AFTER_SCAN_K = [[0.822980691760254, -1.0285341171020508, -0.07401457293090821, 2.4052818726562504, -0.034898062884521484, 0.2653786760009766, -0.02531068297119141],
[0.7819467057312012, -0.6914418393493653, -0.04601942358398438, 2.1847721346496582, -0.04026699563598633, -1.2570972542358398, -0.027228158953857422]]
Q_BEFORE_SCAN_K = [[0.8839564280090333, -0.7539515563842774, -0.1817767231567383, 2.2756604962280274, 0.1606844873474121, 0.16221846813354493, -0.18944662708740237]]

Q_AFTER_GRASP_K = [[0.7819467057312012, -0.6914418393493653, -0.04601942358398438, 2.1847721346496582, -0.04026699563598633, -1.2570972542358398, -0.027228158953857422],
[0.9522185729919435, -0.9318933275756837, 0.008820389520263672, 2.357728468286133, -0.0364320436706543, -0.22587867075805665, 0.09664078952636719]
]

################################################################################################
Q_SCAN_BIN_L = [0.8091748646850586, -0.3555000471862793, -0.37352432142333986, 1.2962137642822267, 0.18829614149780274, 0.8383204996215821, -0.1710388576538086]
Q_SCAN_BIN_L_HAYDEN = [-0.08858739039916992, 0.42069423059692385, 1.285475898779297, 0.8187622445983888, -1.8158497555847168, 1.0561457712524416, -0.09012137118530274]
Q_IK_SEED_L = [0.09855826550903321, -0.3010437292785645, 0.18983012228393556, 1.6264031284973146, -0.6109078480773926, -1.302733182623291, -0.0015339807861328126]

Q_AFTER_SCAN_L = [
	[0.0847524384338379, -0.25847576246337894, 0.0011504855895996095, 1.7905390726135255, -0.7478156332397461, -0.06250971703491211, -0.10507768385009766],
	[0.08015049607543946, -0.30794664281616213, 0.04755340437011719, 1.802427423706055, -0.6331505694763184, -1.4956312664794922, -0.06250971703491211]
]

Q_BEFORE_SCAN_L = [
	[0.6876068873840332, -0.22396119477539064, -0.033364082098388675, 1.864937140740967, -0.3175340227294922, -0.26116022883911133, 0.1100631214050293]
]

Q_AFTER_GRASP_L = [
	[0.08015049607543946, -0.30794664281616213, 0.04755340437011719, 1.802427423706055, -0.6331505694763184, -1.4956312664794922, -0.06250971703491211],
	[0.15953400175781252, -0.4506068559265137, 0.04448544279785156, 2.4225391565002443, -0.830650595690918, -1.2935292979064943, -0.0732475825378418]

]

################################################################################################
Q_STOW = [1.0, 0.28, 0.0, 0.9, 0.0, 0.0, 0.0]

# Right arm calibration configs, see pics on Google Drive
Q_CALIBRATE_BIN_E = [1.198805984362793, -0.551082597418213, -0.4406359808166504, 1.0392719826049805, 0.42069423059692385, -0.5196359913024903, -0.14189322271728516]
Q_CALIBRATE_BIN_H = [0.9088836157836915, -0.1096796262084961, -0.46364569260864263, 0.6841554306152344, 0.5288398760192872, -0.3531990760070801, -0.15531555459594729]

# 7 list, each element is a 2 list of lower then upper acceptable bound
ELBOW_UP_BOUNDS = [[-10, 10], [-10, 10], [-1.5, 1.5], [-10, 10], [-.5, .5], [-10, 10], [-10, 10]]

# Number of histograms per object
NUM_HIST_PER_OBJECT = 4

# Left arm configurations
Q_SPATULA_AT_BIN = [0.08053399127197267, 0.5610534725280762, -1.4894953433349611, 0.830650595690918, -2.828277074432373, -1.3989904769531252, 0.0]

# Paths
REPO_ROOT = "/home/group3/ece490-s2016"
KLAMPT_MODELS_DIR = REPO_ROOT + "/apc2015/klampt_models/"
LIBPATH = REPO_ROOT + "/common/"
VACUUM_PCD_FILE = REPO_ROOT + "/group3/planning/custom_vacuum.pcd"
PICK_JSON_PATH = REPO_ROOT + '/group3/integration/apc_pick_task.json'
PERCEPTION_DIR = REPO_ROOT + "/group3/perception"
BIN_NPZ_FOLDER = PERCEPTION_DIR + "/empty_bins/" # A.npz, B.npz
MAT_PATH = PERCEPTION_DIR + "/matpcl/"
CLOUD_MAT_PATH = MAT_PATH + "cloud.mat"
CHENYU_GO_PATH = MAT_PATH + "chenyugo.txt"
CHENYU_DONE_PATH = MAT_PATH + "chenyudone.txt"
ARDUINO_SERIAL_PORT = "/dev/ttyACM0"
ROS_DEPTH_TOPIC = "/realsense/pc"
PICK_JSON_PATH = REPO_ROOT + '/group3/planning/apc_pick_task.json'

# Indices in Baxter robot file link
LEFT_CAMERA_LINK_NAME = 'left_hand_camera'
RIGHT_CAMERA_LINK_NAME = 'right_hand_camera'
LEFT_GRIPPER_LINK_NAME = 'left_gripper'
RIGHT_GRIPPER_LINK_NAME = 'right_gripper'
LEFT_ARM_LINK_NAMES = ['left_upper_shoulder','left_lower_shoulder','left_upper_elbow','left_lower_elbow','left_upper_forearm','left_lower_forearm','left_wrist']
RIGHT_ARM_LINK_NAMES = ['right_upper_shoulder','right_lower_shoulder','right_upper_elbow','right_lower_elbow','right_upper_forearm','right_lower_forearm','right_wrist']

# Local transform from right_wrist to vacuum point
VACUUM_POINT_XFORM = (so3.identity(), [.14, 0.0, .43])

# Local transform from right_lower_forearm to F200
RIGHT_F200_CAMERA_CALIBRATED_XFORM = ([0.03041006181767996, 0.016744860249637956, -0.9993972372362588, 0.990578526979957, 0.13306496892712172, 0.032371220715998364, 0.13352681388569373, -0.9909658539524185, -0.012540585069730208], [0.13, -0.12000000000000001, -0.02999999999999997])

# Transform of shelf relative to world
SHELF_MODEL_XFORM = [1.43,-.25,-.03]

# Distances (meters)
GRASP_MOVE_DISTANCE = .07
COM_ADJUSTMENT = [.03, 0.0, GRASP_MOVE_DISTANCE]
COM_Y_ADJUSTMENT = 0.0
MEAN_OBJ_HEIGHT = .05
BACK_UP_DISTANCE = .2

# Times (seconds)
MOVE_TIME = 2
SCAN_WAIT_TIME = 4 if REAL_PERCEPTION else 0
GRASP_WAIT_TIME = 3 if REAL_VACUUM else 0

# Terminal colors
OKBLUE = '\033[94m'
OKGREEN = '\033[92m'
FAIL_COLOR = '\033[91m'
WARNING_COLOR = '\033[93m'
END_COLOR = '\033[0m'


ITEM_SCORES = {
    "i_am_a_bunny_book":1,
    "laugh_out_loud_joke_book":1,
    "scotch_bubble_mailer":1,
    "up_glucose_bottle":1,
    "dasani_water_bottle":10,
    "rawlings_baseball":1,
    "folgers_classic_roast_coffee":10,
    "elmers_washable_no_run_school_glue":1,
    "hanes_tube_socks":1,
    "womens_knit_gloves":1,
    "cherokee_easy_tee_shirt":1,
    "peva_shower_curtain_liner":1,
    "cloud_b_plush_bear":1,
    "barkely_hide_bones":1,
    "kyjen_squeakin_eggs_plush_puppies":1,
    "cool_shot_glue_sticks":1,
    "creativity_chenille_stems":1,
    "soft_white_lightbulb":1,
    "safety_first_outlet_plugs":1,
    "oral_b_toothbrush_green":1,
    "dr_browns_bottle_brush":1,
    "command_hooks":1,
    "easter_turtle_sippy_cup":5,
    "fiskars_scissors_red":5,
    "scotch_duct_tape":1,
    "woods_extension_cord":1,
    "platinum_pets_dog_bowl":10,
    "fitness_gear_3lb_dumbbell":10,
    "rolodex_jumbo_pencil_cup":10,
    "clorox_utility_brush":1,
    "kleenex_paper_towels":5,
    "expo_dry_erase_board_eraser":1,
    "kleenex_tissue_box":1,
    "ticonderoga_12_pencils":1,
    "crayola_24_ct":1,
    "jane_eyre_dvd":1,
    "dove_beauty_bar":1,
    "staples_index_cards":1,
    "oral_b_toothbrush_red": 1
}

ITEM_NUMBERS = {
    "i_am_a_bunny_book":1,
    "laugh_out_loud_joke_book":2,
    "scotch_bubble_mailer":3,
    "up_glucose_bottle":4,
    "dasani_water_bottle":5,
    "rawlings_baseball":6,
    "folgers_classic_roast_coffee":7,
    "elmers_washable_no_run_school_glue":8,
    "hanes_tube_socks":9,
    "womens_knit_gloves":10,
    "cherokee_easy_tee_shirt":11,
    "peva_shower_curtain_liner":12,
    "cloud_b_plush_bear":13,
    "barkely_hide_bones":14,
    "kyjen_squeakin_eggs_plush_puppies":15,
    "cool_shot_glue_sticks":16,
    "creativity_chenille_stems":17,
    "soft_white_lightbulb":18,
    "safety_first_outlet_plugs":19,
    "oral_b_toothbrush_green":20,
    "dr_browns_bottle_brush":21,
    "command_hooks":22,
    "easter_turtle_sippy_cup":23,
    "fiskars_scissors_red":24,
    "scotch_duct_tape":25,
    "woods_extension_cord":26,
    "platinum_pets_dog_bowl":27,
    "fitness_gear_3lb_dumbbell":28,
    "rolodex_jumbo_pencil_cup":29,
    "clorox_utility_brush":30,
    "kleenex_paper_towels":31,
    "expo_dry_erase_board_eraser":32,
    "kleenex_tissue_box":33,
    "ticonderoga_12_pencils":34,
    "crayola_24_ct":35,
    "jane_eyre_dvd":36,
    "dove_beauty_bar":37,
    "staples_index_cards":38,
    "oral_b_toothbrush_red":39
}
